# Epoch and Learning-Rate variables
num_epochs: 13.0
pruning_epochs: 10.0
init_lr: 0.00025
inter_func: cubic
mask_type: unstructured

training_modifiers:
  - !EpochRangeModifier
    start_epoch: 0.0
    end_epoch: eval(num_epochs)

  - !LearningRateFunctionModifier
    final_lr: 0.0
    init_lr: eval(init_lr)
    lr_func: cosine
    start_epoch: 0.0
    end_epoch: eval(num_epochs)

# Pruning
pruning_modifiers:
   - !GlobalMagnitudePruningModifier
     init_sparsity: 0.05
     final_sparsity: 0.90
     start_epoch: 0.0
     end_epoch: eval(pruning_epochs)
     update_frequency: 1.0
     params: 
        - 'conv1.weight'
        - 're:layer1.*.conv1.weight'
        - 're:layer1.*.conv2.weight'
        - 're:layer1.*.conv3.weight'
        - 're:layer1.0.downsample.0.weight'
        - 're:layer2.*.conv1.weight'
        - 're:layer2.*.conv2.weight'
        - 're:layer2.*.conv3.weight'
        - 're:layer2.0.downsample.0.weight'
        - 're:layer3.*.conv1.weight'
        - 're:layer3.*.conv2.weight'
        - 're:layer3.*.conv3.weight'
        - 're:layer3.0.downsample.0.weight'
        - 're:layer4.*.conv1.weight'
        - 're:layer4.*.conv2.weight'
        - 're:layer4.*.conv3.weight'
        - 're:layer4.0.downsample.0.weight'
     leave_enabled: True
     inter_func: eval(inter_func)
     mask_type: eval(mask_type)